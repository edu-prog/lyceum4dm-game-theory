<!DOCTYPE html>
<html lang="en">

<head>
    <title>Shower Presentation Engine</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdn.eduprog.ru/styles.css" >
    <style>
        .shower {
            --slide-ratio: calc(16 / 9);
        }

        .slide {
            background: #010123;
        }

        .title {
            color: #fff !important;
        }

        * {
            color: #fff;
        }

        .function_name {
            color: #61afef;
        }

        .keyword {
            color: #c678dd;
        }

        .var {
            color: #d19a66;
        }

        .string {
            color: #98c374;
        }

        .default_func {
            color: #56b6c2;
        }

        .comment {
            color: #7a848e;
        }

        .list-item {
            display: flex;
            align-items: center;
        }

        .list-item span {
            margin-right: 40px;
            font-size: 40px;
            font-weight: 700;
            color: #006be7;
        }
    </style>
</head>

<body class="shower list">

    <header class="caption">
        <h1>Теория игр без боли</h1>
        <p>Eduprog Inc.</p>
    </header>

    <section class="slide">
        <h1 style="position: absolute; top: 50%; transform: translateY(-50%); font-size: 4rem; margin: 0; color: #fff;">Теория игр без боли</h1>
        <p style="position: absolute; top: 70%; color: #808093;">Свиридов Василий<br><a>vasily-sviridov@yandex-team.ru</a></p>

        <span style="font-size: 200px; color: #0077fc; font-weight: 1000; position: absolute; right: 4rem; top: -60px">
            ++
        </span>

        <div style="border: 1.5rem solid #1c1c51; background: #010123; width: 100px; height: 100px; border-radius: 50%; position: absolute; right: 2rem; top: 50%;"></div>

        <div style="border: 1.5rem solid #0077fc; background: #010123; width: 100px; height: 100px; border-radius: 50%; position: absolute; top: -80px"></div>

        <span style="font-size: 200px; color: #1c1c51; font-weight: 1000; position: absolute; left: 5px;">
        }
        </span>

        <span style="font-size: 200px; color: #1c1c51; font-weight: 1000; position: absolute; bottom: -10%; right: 40%;">
        +
        </span>

        <span style="font-size: 150px; color: #1c1c51; font-weight: 1000; position: absolute; top: -10%; right: 40%;">
            :
        </span>
    </section>

    <section class="slide">
        <h2 class="title">Содержание</h2>

        <span style="position: absolute; font-size: 200px; top: -100px; right: 75px; color: #1c1c51; font-weight: 700">+</span>
        
        <span style="position: absolute; font-size: 200px; top: -60px; right: 170px; color: #1c1c51; font-weight: 700">+</span>

        <div class="list-item next">
            <span>01</span> Рекурсия
        </div>
        <div class="list-item next">
            <span>02</span> Примеры рекурсивных алгоритмов
        </div>
        <div class="list-item next">
            <span>03</span> Построение дерева рекурсии
        </div>
        <div class="list-item next">
            <span>04</span> Реализация решения задач на теорию игр
        </div>
    </section>

    <section class="slide">
        <h2 class="title">Рекурсия</h2>

        <p class="next" style="margin: 0">Существует два шага рекурсии:</p>
        <ul>
            <li class="next">Базовый инвариант рекурсии</li>
            <li class="next">Вызов подзадач</li>
        </ul>
        <p class="next">Рассмотрим это на примере алгоритма</p>
    </section>

    <section class="slide">
        <h2 class="title">Нахождения факториала</h2>

        <pre>
            <code><span class="keyword">def</span> <span class="function_name">factorial</span>(<span class="var">n</span>):</code>
            <code >      <span class="keyword">if</span> n <span class="default_func">==</span> <span class="var">0</span>:</code>
            <code>          <span class="keyword">return</span> <span class="var">1</span></code>
            <code>      <span class="keyword">else</span>:</code>
            <code>          <span class="keyword">return</span> n <span class="default_func">*</span> <span class="function_name">factorial</span>(n <span class="default_func">-</span> <span class="var">1</span>)</code>
        </pre>
    </section>

    <section class="slide">
        <h2 class="title">Нахождения факториала</h2>

        <pre>
            <code><span class="keyword">def</span> <span class="function_name">factorial</span>(<span class="var">n</span>):</code>
            <code class="mark">      <span class="keyword">if</span> n <span class="default_func">==</span> <span class="var">0</span>:</code>
            <code class="mark">          <span class="keyword">return</span> <span class="var">1</span></code>
            <code>      <span class="keyword">else</span>:</code>
            <code>          <span class="keyword">return</span> n <span class="default_func">*</span> <span class="function_name">factorial</span>(n <span class="default_func">-</span> <span class="var">1</span>)</code>
        </pre>
    </section>

    <section class="slide">
        <h2 class="title">Нахождения факториала</h2>

        <pre>
            <code><span class="keyword">def</span> <span class="function_name">factorial</span>(<span class="var">n</span>):</code>
            <code>      <span class="keyword">if</span> n <span class="default_func">==</span> <span class="var">0</span>:</code>
            <code>          <span class="keyword">return</span> <span class="var">1</span></code>
            <code>      <span class="keyword">else</span>:</code>
            <code class="mark">          <span class="keyword">return</span> n <span class="default_func">*</span> <span class="function_name">factorial</span>(n <span class="default_func">-</span></M> <span class="var">1</span>)</code>
        </pre>
    </section>

    <section class="slide">
        <h2 class="title">Нахождение числа Фибоначчи</h2>
        <pre>
            <code><span class="keyword">def</span> <span class="function_name">fib</span>(<span class="var">n</span>):</code>
            <code>      <span class="keyword">if</span> n <span class="default_func"><=</span> <span class="var">2</span>:</code>
            <code>          <span class="keyword">return</span> <span class="var">1</span></code>
            <code>      <span class="keyword">else</span>:</code>
            <code>          <span class="keyword">return</span> <span class="function_name">fib</span>(n <span class="default_func">-</span> <span class="var">1</span>) <span class="default_func">+</span> <span class="function_name">fib</span>(n <span class="default_func">-</span> <span class="var">2</span>)</code>
        </pre>
    </section>

    <section class="slide">
        <h2 class="title">Рассмотрим дерево рекурсии</h2>
        
        <img style="width: 800px" src="https://i.imgur.com/i4RYZQn.png" alt="">
    </section>

    <section class="slide">
        <h2 class="title">Проблемы рекурсивного обхода</h2>

        <ul>
            <li class="next">Возьмем fib(45):</li>
            <li class="next">Для получения результата нам нужно обойти <b>2269806339</b> вершин.</li>
            <li class="next">Эх, вот бы был какой-нибудь способ запоминать значения в вычисленных вершинах.</li>
        </ul>

        <img class="next" style="width: 200px; position: absolute; right: 100px; bottom: 91px;" src="https://cdn.eduprog.ru/img/not_optimal.webp" alt="">
    </section>

    <section class="slide">
        <h2 class="title">И он есть у меня!</h2>

        В Python 3.5 появился инструмент для сохранения вычисленных веток рекурсии:

        <pre>
            <code class="next mark"><span class="keyword">from</span> functools <span class="keyword">import</span> lru_cache</code>
            <code> </code>
            <code class="next mark"><span class="function_name">@lru_cache</span>(<span class="var">None</span>)</code>
            <code><span class="keyword">def</span> fib(<span class="var">n</span>):</code>
            <code>      <span class="comment"># ...</span></code>
        </pre>
    </section>

    <section class="slide">
        <h2 class="title">Перейдем к теории игр.</h2>

        Есть такая задача:
        <br>
        За один ход игрок может <b>добавить в одну из куч три камня</b> или <b>увеличить количество камней в куче в два раза</b>. Игра завершается в тот момент, когда суммарное количество камней в кучах становится <b>не менее 62</b>. В начальный момент в первой куче было 7 камней, во второй куче – S камней; 1 ≤ S ≤ 54.
    </section>

    <section class="slide">
        <h2 class="title">Перейдем к теории игр.</h2>

        <ul>
            <li class="next">В 19 задании нужно найти B1, при неудачном ходе P</li>
            <li class="next">В 20 задании нужно найти минимальный P2</li>
            <li class="next">В 21 задании нужно найти 2 ∃s, при которых B2</li>
        </ul>

        <p class="next">Перейдем к написанию кода</p>
    </section>

    <section class="slide">
        <h2 class="title">Запрогаем задачу</h2>

        Для начала распишем все возможные ходы:

        <pre>
            <code><span class="keyword">def</span> <span class="function_name">moves</span>(<span class="var">h</span>):</code>
            <code>      a, b <span class="default_func">=</span> h</code>
            <code>      <span class="keyword">return</span> (a <span class="default_func">+</span> <span class="var">3</span>, b), (a, b <span class="default_func">+</span> <span class="var">3</span>), (a <span class="default_func">*</span> <span class="var">2</span>, b), (a, b <span class="default_func">*</span> <span class="var">2</span>)</code>
        </pre>
    </section>

    <section class="slide">
        <h2 class="title">Запрогаем задачу</h2>
        <pre>
            <code><span class="function_name">@lru_cache</span>(<span class="var">None</span>)</code>
            <code><span class="keyword">def</span> <span class="function_name">game</span>(<span class="var">h</span>):</code>
            <code>      <span class="keyword">if</span> <span class="default_func">sum</span>(h) <span class="default_func">>=</span> <span class="var">62</span>:</code>
            <code>          <span class="keyword">return</span> <span class="string">"W"</span></code>
            <code>      <span class="keyword">elif</span> <span class="default_func">any</span>(<span class="function_name">game</span>(m) <span class="default_func">==</span> <span class="string">"W"</span> <span class="keyword">for</span> m <span class="keyword">in</span> <span class="function_name">moves</span>(h)):</code>
            <code>          <span class="keyword">return</span> <span class="string">"P1"</span></code>
            <code>      <span class="keyword">elif</span> <span class="default_func">all</span>(<span class="function_name">game</span>(m) <span class="default_func">==</span> <span class="string">"P1"</span> <span class="keyword">for</span> m <span class="keyword">in</span> <span class="function_name">moves</span>(h)):</code>
            <code>          <span class="keyword">return</span> <span class="string">"B1"</span></code>
        </pre>
    </section>

    <section class="slide">
        <h2 class="title">Запрогаем задачу</h2>
        <pre>
            <code><span class="comment"># Продолжение game(h):</span></code>
            <code><span class="keyword">elif</span> <span class="default_func">any</span>(<span class="function_name">game</span>(m) <span class="default_func">==</span> <span class="string">"B1"</span> <span class="keyword">for</span> m <span class="keyword">in</span> <span class="function_name">moves</span>(h)):</code>
            <code>      <span class="keyword">return</span> <span class="string">"P2"</span></code>
            <code><span class="keyword">elif</span> <span class="default_func">all</span>(<span class="function_name">game</span>(m) <span class="default_func">==</span> <span class="string">"P1"</span> <span class="keyword">or</span> <span class="function_name">game</span>(m) <span class="default_func">==</span> <span class="string">"P2"</span> <span class="keyword">for</span> m <span class="keyword">in</span> <span class="function_name">moves</span>(h)):</code>
            <code>      <span class="keyword">return</span> <span class="string">"B2"</span></code>
        </pre>
    </section>

    <section class="slide">
        <h2 class="title">Запрогаем задачу</h2>
        Переберем значения S из условия:

        <pre>
            <code><span class="keyword">for</span> s <span class="keyword">in</span> <span class="default_func">range</span>(<span class="var">1</span>, <span class="var">55</span>):</code>
            <code>      h <span class="default_func">=</span> <span class="default_func">(</span><span class="var">7</span>, s<span class="default_func">)</span></code>
            <code>      <span class="keyword">if</span> <span class="function_name">game</span>(h) <span class="keyword">is not None</span>:</code>
            <code>          <span class="default_func">print</span>(<span class="function_name">game</span>(h), s)</code>
        </pre>
    </section>

    <section class="slide">
        <h2 class="title">Посмотрим на вывод программы</h2>
        
        <ul>
            <li>P2 13</li>
            <li>B2 20</li>
            <li>B2 22</li>
            <li>P2 23</li>
            <li>P2 24</li>
            <li>P2 25</li>
            <li>B1 26</li>
            <li>...</li>
        </ul>

    </section>

    <section class="slide">
        <h2 class="title">Что нам нужно было найти?)</h2>

        <div class="columns two">
            <ul>
                <li>19. B1, при неудачном ходе P</li>
                <li>20. min(P2)</li>
                <li>21. 2 ∃s = B2</li>
            </ul>

            <ul>
                <li>P2 13</li>
                <li>B2 20</li>
                <li>B2 22</li>
                <li>P2 23</li>
                <li>P2 24</li>
                <li>P2 25</li>
                <li>B1 26</li>
                <li>...</li>
            </ul>
        </div>
    </section>

    <section class="slide">
        <h2 class="title">А как быть с неудачным ходом Первого игрока?</h2>

        Рассмотрим, как мы формируем выигрышные стратегии P1:
        <div class="spotlight next" style="
        --spotlight-radius: 50%;
        --spotlight-opacity: 0.2;
        --spotlight-size: 100px;
        top: 48%;
        left: 280px;
        opacity: 0.2;
        background-color: #0020ff;
    "></div>
        <pre>
            <code>      <span class="keyword">elif</span> <span class="default_func">all</span>(<span class="function_name">game</span>(m) <span class="default_func">==</span> <span class="string">"P1"</span> <span class="keyword">for</span> m <span class="keyword">in</span> <span class="function_name">moves</span>(h)):</code>
            <code>          <span class="keyword">return</span> <span class="string">"B1"</span></code>
        </pre>

        Заменим "all" на "any":

        <pre>
            <code>      <span class="keyword">elif</span> <span class="default_func">any</span>(<span class="function_name">game</span>(m) <span class="default_func">==</span> <span class="string">"P1"</span> <span class="keyword">for</span> m <span class="keyword">in</span> <span class="function_name">moves</span>(h)):</code>
            <code>          <span class="keyword">return</span> <span class="string">"B1"</span></code>
        </pre>
    </section>

    <section class="slide">
        <h2 class="title">Output</h2>

        <ul>
            <li>...</li>
            <li>P2 10</li>
            <li>P2 11</li>
            <li>P2 12</li>
            <li>P2 13</li>
            <li>B1 14</li>
            <li>B1 15</li>
            <li>...</li>
        </ul>
    </section>

    <section class="slide">
        <h2 class="title">Решите аналогичную задачу</h2>
        <ul>
            <li>19. min(S) = B1</li>
            <li>20. 2 ∃s = P2</li>
            <li>21. count(B2)</li>
        </ul>
    </section>

    <section class="slide">
        <h2 class="title">Решите аналогичную задачу</h2>
        32)	(А. Носкин) За один ход игрок может <b>добавить в одну из куч один камень</b> или <b>увеличить количество камней в куче в два раза</b>. Игра завершается в тот момент, когда суммарное количество камней в кучах становится не менее <b>40</b>. Победителем считается игрок, сделавший последний ход, т.е. первым получивший такую позицию, при которой в кучах будет <b>40</b> или больше камней. В начальный момент в первой куче было <b>9</b> камней, во второй куче – S камней; <b></b>1 ≤ S ≤ 30</b>.
    </section>

    <section class="slide">
        <h2 class="title">Ответы</h2>
        
        <ul>
            <li>19. <b>4</b></li>
            <li>20. <b>3 14</b></li>
            <li>21. <b>0</b></li>
        </ul>

        Также, вы можете посмотреть моё решение этой задачи:

        <a href="https://re.eduprog.ru/l/1">re.eduprog.ru/l/1</a>
    </section>

    <section class="slide">
        <div class="columns two" style="display: flex; height: calc(100% - 80px); align-items: center; justify-content: space-between;">
            <div>
                <h1 style="font-size: 40px; margin: 5px 0;">Свиридов Василий</h1>
                <h1 style="font-size: 26px; font-weight: 400; margin: 5px 0; margin-bottom: 40px;">Разработчик Yandex.Clickhouse</h2>
                
                <a href="">vasily-sviridov@yandex-team.ru</a>
                <a href="">sviridov@eduprog.ru</a>
            </div>

            <div style="display: flex; flex-direction: column;">
                <div style="text-align: center;">Презентация:</div>
                <img style="width: 300px;" src="https://cdn.eduprog.ru/img/qr-code.png" alt="link to presentation">
            </div>
        </div>
    </section>

    <footer class="badge">
        <a href="https://github.com/edu-prog/lyceum4m-game-theory">
            <svg width="81" height="79" viewBox="0 0 81 79" aria-hidden="true">
                <path
                    d="M40.5 0a40.5 40.5 0 0 0-12.8 78.93c2 .37 2.76-.88 2.76-2s0-3.51-.05-6.89c-11.27 2.45-13.64-5.43-13.64-5.43-1.84-4.68-4.5-5.92-4.5-5.92-3.68-2.51.28-2.46.28-2.46 4.06.29 6.2 4.17 6.2 4.17 3.61 6.19 9.48 4.4 11.79 3.37a8.65 8.65 0 0 1 2.57-5.41c-9-1-18.45-4.5-18.45-20a15.65 15.65 0 0 1 4.17-10.87 14.57 14.57 0 0 1 .4-10.72s3.4-1.09 11.14 4.15a38.39 38.39 0 0 1 20.28 0c7.73-5.24 11.13-4.15 11.13-4.15a14.55 14.55 0 0 1 .4 10.72 15.63 15.63 0 0 1 4.16 10.87c0 15.56-9.47 19-18.49 20 1.45 1.25 2.75 3.72 2.75 7.5v11.11c0 1.08.73 2.34 2.78 1.95A40.51 40.51 0 0 0 40.5 0z">
                </path>
            </svg>
            Fork me<br>on GitHub
        </a>
    </footer>

    <div class="progress"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/shower-core/2.1.0/shower.min.js"></script>
</body>

</html>